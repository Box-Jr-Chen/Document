# 使用docker-compose
資料結構:

    nginx-php
      -conf.d
        -default.conf
      - public_html
        -網頁在裡面
      

### default.conf :

    ##
    # You should look at the following URL's in order to grasp a solid understanding
    # of Nginx configuration files in order to fully unleash the power of Nginx.
    # https://www.nginx.com/resources/wiki/start/
    # https://www.nginx.com/resources/wiki/start/topics/tutorials/config_pitfalls/
    # https://wiki.debian.org/Nginx/DirectoryStructure
    #
    # In most cases, administrators will remove this file from sites-enabled/ and
    # leave it as reference inside of sites-available where it will continue to be
    # updated by the nginx packaging team.
    #
    # This file will automatically load configuration files provided by other
    # applications, such as Drupal or Wordpress. These applications will be made
    # available underneath a path with that package name, such as /drupal8.
    #
    # Please see /usr/share/doc/nginx-doc/examples/ for more detailed examples.
    ##

    # Default server configuration
    #
    server {
      listen 80 default_server;
      listen [::]:80 default_server;

      # SSL configuration
      #
      # listen 443 ssl default_server;
      # listen [::]:443 ssl default_server;
      #
      # Note: You should disable gzip for SSL traffic.
      # See: https://bugs.debian.org/773332
      #
      # Read up on ssl_ciphers to ensure a secure configuration.
      # See: https://bugs.debian.org/765782
      #
      # Self signed certs generated by the ssl-cert package
      # Don't use them in a production server!
      #
      # include snippets/snakeoil.conf;

      root /public_html;

      # Add index.php to the list if you are using PHP
      index index.html index.htm index.nginx-debian.html;

      server_name _;

      location / {
        try_files $uri $uri/ /index.php?args;
      }

        location ~* \.php$ {
                try_files $uri =404;
                fastcgi_split_path_info ^(.+\.php)(/.+)$;

                # fastcgi_pass unix:/var/run/php/php8.0-fpm.sock;
          fastcgi_pass  php:9000;
                fastcgi_index index.php;
                fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;
          fastcgi_param PATH_INFO $fastcgi_path_info;
                include fastcgi_params;
        }

      location ~ /\.ht {
                deny all;
        }

      # pass PHP scripts to FastCGI server
      #
      #location ~ \.php$ {
      #	include snippets/fastcgi-php.conf;
      #
      #	# With php-fpm (or other unix sockets):
      #	fastcgi_pass unix:/run/php/php7.4-fpm.sock;
      #	# With php-cgi (or other tcp sockets):
      #	fastcgi_pass 127.0.0.1:9000;
      #}

      # deny access to .htaccess files, if Apache's document root
      # concurs with nginx's one
      #
      #location ~ /\.ht {
      #	deny all;
      #}
    }


    # Virtual Host configuration for example.com
    #
    # You can move that to a different file under sites-available/ and symlink that
    # to sites-enabled/ to enable it.
    #
    #server {
    #	listen 80;
    #	listen [::]:80;
    #
    #	server_name example.com;
    #
    #	root /var/www/example.com;
    #	index index.html;
    #
    #	location / {
    #		try_files $uri $uri/ =404;
    #	}
    #}



### docker-compose.yml:

    version: '3'

    services:
      web:
       image: nginx:alpine
       ports:
        - 80:80
       volumes:
        - ./public_html:/public_html
        - ./conf.d:/etc/nginx/conf.d
       networks:
        - nginxphp

      php:
       image: php:7.1.11-fpm-alpine
       volumes:
        - ./public_html:/public_html
       expose:
        - 9000
       networks:
        - nginxphp

    networks:
     nginxphp:
     
     
### 執行:

    sudo docker-compose up --build
